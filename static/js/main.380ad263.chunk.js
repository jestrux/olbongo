(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{110:function(e,t,n){},112:function(e,t,n){},134:function(e,t,n){},136:function(e,t,n){},138:function(e,t,n){},140:function(e,t,n){},142:function(e,t,n){},144:function(e,t,n){},146:function(e,t,n){},148:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),s=n(19),i=n.n(s),r=n(9),c=n.n(r),l=n(12),m=n(1),u=n(2),d=n(4),p=n(3),h=n(5),f=(n(55),n(7)),g=n.n(f),v=n(6),b=(n(76),n(47)),E=function(e){var t=e.notification,n=t.message;Object(b.a)(t,["message"]);return o.a.createElement("div",{className:"notif show",dangerouslySetInnerHTML:{__html:n}})},k=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];var o=n&&n.length?n[0]:{};return new CustomEvent("ot-notification",{detail:{message:e,options:o}})},w=function(e){document.dispatchEvent(e)},C=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={notifications:[]},n.showNotification=function(e){n.setState({notifications:Object(v.a)(n.state.notifications).concat([e])},function(){setTimeout(function(){var t=Object(v.a)(n.state.notifications).filter(function(t){return t.id!==e.id});n.setState({notifications:t})},3e3)})},n.wrapper=o.a.createRef(),n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("ot-notification",function(t){var n=t.detail;n.id="ot-notif-"+Math.random().toString(36).substr(2,5),e.showNotification(n)},!1)}},{key:"render",value:function(){var e=this.state.notifications;return o.a.createElement("div",{className:"ot-notifications-wrapper"},e.reverse().map(function(e,t){return o.a.createElement(E,{key:t,notification:e})}))}}]),t}(o.a.Component),O=n(13),y=(n(78),n(41)),S=n.n(y),N=function(e){function t(){var e,n;Object(m.a)(this,t);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(n=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={username:"",password:""},n.inputChanged=function(e){n.setState(Object(O.a)({},e.target.name,e.target.value))},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.state,n=t.username,a=t.password,s=n.length>0&&a.length>0;return o.a.createElement("div",{className:"ot-login-page"},o.a.createElement("form",{className:"ot-login-form",autoComplete:"off"},o.a.createElement("div",{className:"ot-login-title layout center"},o.a.createElement("img",{src:S.a,height:"50px",alt:""}),"Otalk Login"),o.a.createElement("div",{className:"ot-input-box"},o.a.createElement("input",{autoFocus:!0,autoComplete:"off",id:"username",className:n.length?"valid":"",required:!0,type:"text",name:"username",value:n,onChange:this.inputChanged}),o.a.createElement("label",{htmlFor:"username"},"Username")),o.a.createElement("div",{className:"ot-input-box"},o.a.createElement("input",{autoComplete:"off",id:"password",className:a.length?"valid":"",required:!0,type:"password",name:"password",value:a,onChange:this.inputChanged}),o.a.createElement("label",{htmlFor:"password"},"Password")),o.a.createElement("button",{type:"button",className:"ot-btn primary rounded "+(s?"":"disabled"),onClick:function(){return e.props.onLogin({username:n,password:a})}},"LOGIN")))}}]),t}(o.a.Component),j=n(42),_=n.n(j),P=n(17),L=n(20),M=(n(83),"https://www.olbongo.com/api/otalk"),x=541,U=(n(85),function(e,t,n,a){a(window.confirm(t))}),F=(n(87),n(89),function(e){var t=e.images,n="",a="";if(t.length>1){switch(t.length){case 2:n="two";break;case 3:n="three";break;case 4:n="four";break;case 5:n="five";break;default:n="four"}n+="-image-grid",t.length>5&&(n+=" has-more"),a=t.length>5?t.length-4:""}var s=t.length>5?4:t.length;return o.a.createElement("div",{className:"ot-post-images "+n,extras:a},t.slice(0,s).map(function(e){return o.a.createElement("div",{key:e.id,className:"ot-post-image"},o.a.createElement("img",{src:e.photo,alt:""}))}))});function T(e){if(/(http|https):\/\/(\w+:{0,1}\w*)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%!\-\/]))?/.test(e)){return e.match(/^.*(youtu\.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/)}return!1}var I=function(e){var t=e.video,n=!!t&&T(t.video),a="";return n&&(a=function(e){return"https://www.youtube.com/embed/".concat(e,"?rel=0&amp;showinfo=0")}(n[2])),o.a.createElement("div",{className:"ot-post-video "+(n?"for-youtube":"")},n&&o.a.createElement("iframe",{title:"post video",src:a,frameBorder:"0",allow:"autoplay; encrypted-media",allowFullScreen:!0}),t&&!n&&o.a.createElement("video",{controls:!0},o.a.createElement("source",{src:t.video})))},R=function(e){var t=e.images,n=e.videos;return o.a.createElement("div",{className:"ot-post-media"},t.length>0&&o.a.createElement(F,{images:t}),!t.length&&n.length>0&&o.a.createElement(I,{video:n[0]}))},D=(n(91),function(){return o.a.createElement("svg",{fill:"#ffa200",className:"ot-post-like-icon",viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),o.a.createElement("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"}))}),A=function(){return o.a.createElement("svg",{fill:"#656565",viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),o.a.createElement("path",{d:"M16.5 3c-1.74 0-3.41.81-4.5 2.09C10.91 3.81 9.24 3 7.5 3 4.42 3 2 5.42 2 8.5c0 3.78 3.4 6.86 8.55 11.54L12 21.35l1.45-1.32C18.6 15.36 22 12.28 22 8.5 22 5.42 19.58 3 16.5 3zm-4.4 15.55l-.1.1-.1-.1C7.14 14.24 4 11.39 4 8.5 4 6.5 5.5 5 7.5 5c1.54 0 3.04.99 3.57 2.36h1.87C13.46 5.99 14.96 5 16.5 5c2 0 3.5 1.5 3.5 3.5 0 2.89-3.14 5.74-7.9 10.05z"}))},V=function(e){return o.a.createElement(o.a.Fragment,null,e.faved?o.a.createElement(D,{key:"favorited_icon"}):o.a.createElement(A,{key:"favorite_icon"}))},W=function(e){var t=e.comment,n=t.id,a=(t.published_at,t.publisher),s=t.author,i=t.content,r=t.is_liked,c=a||s,l=c.dp,m=c.display_name;return o.a.createElement("div",{className:"ot-post-comment layout "+(-1!==n.toString().indexOf("ot-temp-id")?"temp":"")},o.a.createElement("div",{className:"ot-dp small"},o.a.createElement("img",{src:l,alt:""})),o.a.createElement("p",null,o.a.createElement("strong",null,m),"\xa0",o.a.createElement("span",{dangerouslySetInnerHTML:{__html:i}})),o.a.createElement("button",{className:"ot-comment-liker ot-btn action",onClick:e.onToggleLiked},o.a.createElement(V,{faved:r})))},H=function(e){function t(){return Object(m.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=(t.fetched,t.comments),a=t.loading;return o.a.createElement("div",{className:"ot-post-comments"},n.length>0&&n.map(function(t,n){return o.a.createElement(W,{key:t.id,comment:t,onToggleLiked:function(){return e.props.onToggleCommentLiked(n)}})}),a&&o.a.createElement("span",{className:"ot-comments-loader"},n.length>0?"loading more comments....":"loading comments...."),!a&&n.length<1&&o.a.createElement("span",{className:"ot-comments-loader"},"No comments"))}}]),t}(o.a.Component),B=n(43),q=n(14),z=n.n(q),J=(n(110),function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(d.a)(this,Object(p.a)(t).call(this,e))).handleChange=function(e){n.setState({comment:e.target.value})},n.handleKeyup=function(e){"Enter"===e.key&&n.state.comment.length&&n.sendComment()},n.addQuickEmoji=function(e){n.setState({comment:n.state.comment+e.target.innerText}),n.inputField.current.textarea.focus()},n.sendComment=function(){var e=JSON.parse(JSON.stringify(n.state)).comment.replace(/\*([^*]+)\*/g,"<b>$1</b>");e.length&&(n.props.onNewComment(e),n.setState({comment:""}))},n.inputField=o.a.createRef(),n.state={comment:"",animate_icon:!0},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.props.autofocus&&this.inputField&&this.inputField.current.textarea.focus()}},{key:"render",value:function(){var e=this.state,t=e.comment,n=e.animate_icon,a=this.props,s=a.user,i=a.faved,r=a.quickemojis,c=n?500:0;return o.a.createElement(o.a.Fragment,null,r&&o.a.createElement("div",{id:"quickEmojis",className:"layout"},o.a.createElement("span",{onClick:this.addQuickEmoji,role:"img","aria-label":"rotfl"},"\ud83e\udd23"),o.a.createElement("span",{onClick:this.addQuickEmoji,role:"img","aria-label":"lol"},"\ud83d\ude02"),o.a.createElement("span",{onClick:this.addQuickEmoji,role:"img","aria-label":"thanks"},"\ud83d\ude4f"),o.a.createElement("span",{onClick:this.addQuickEmoji,role:"img","aria-label":"respect"},"\ud83d\ude4c"),o.a.createElement("span",{onClick:this.addQuickEmoji,role:"img","aria-label":"wink"},"\ud83d\ude09"),o.a.createElement("span",{onClick:this.addQuickEmoji,role:"img","aria-label":"hmmm"},"\ud83e\udd14"),o.a.createElement("span",{onClick:this.addQuickEmoji,role:"img","aria-label":"angry"},"\ud83d\ude21"),o.a.createElement("span",{onClick:this.addQuickEmoji,role:"img","aria-label":"watching"},"\ud83d\udc40")),o.a.createElement("div",{className:"ot-post-commenter layout center"},o.a.createElement("div",{className:"ot-dp small self-start"},o.a.createElement("img",{src:s.dp,alt:""})),o.a.createElement(z.a,{ref:this.inputField,placeholder:"Write a Comment",className:"flex input",rows:1,onChange:this.handleChange,onKeyUp:this.handleKeyup,onClick:this.props.onFocused,value:t}),o.a.createElement("div",{className:"ot-post-commenter-actions self-end"+(!t.length&&this.props.onToggleLiked?" can-like":"")},o.a.createElement("button",{className:"ot-btn flat "+(t.length?"":"disabled"),onClick:this.sendComment},"POST"),o.a.createElement("button",{className:"ot-post-liker ot-btn action",onClick:this.props.onToggleLiked},o.a.createElement(B.MorphReplace,{width:20,height:20,duration:c,rotation:"none"},i?o.a.createElement(D,{key:"favorited_icon"}):o.a.createElement(A,{key:"favorite_icon"}))))))}}]),t}(o.a.Component)),K=function(e){var t=e.user,n=e.post,a=n.fetching_comments,s=n.is_liked,i=n.publisher,r=n.published_at,c=n.content,l=n.images,m=n.videos,u=n.comments,d=n.total_likes,p=n.total_commenets,h=i.id===t.id,f=d+" Like";f+=1!==d?"s":"";var g=p+" Comment";return g+=1!==p?"s":"",o.a.createElement("div",{className:"ot-post-item"},o.a.createElement("div",{className:"ot-post-item-title layout center"},o.a.createElement("div",{className:"ot-dp",onClick:e.onViewUser},o.a.createElement("img",{src:i.dp,alt:""})),o.a.createElement("div",null,o.a.createElement("span",{className:"ot-post-item-owner",onClick:e.onViewUser},i.display_name),o.a.createElement("span",{className:"ot-post-item-date"},r)),o.a.createElement("span",{className:"flex"}),h&&o.a.createElement("div",{className:"ot-post-manager"},o.a.createElement("button",{className:"ot-post-options-btn ot-btn action"},o.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),o.a.createElement("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}))),o.a.createElement("div",{className:"ot-post-manager-options"},o.a.createElement("button",{onClick:e.onEditPost,className:"ot-btn flat"},"Edit"),o.a.createElement("button",{onClick:e.onDeletePost,className:"ot-btn flat"},"Delete")))),o.a.createElement("p",{className:"ot-post-item-content"},c),(l.length>0||m.length>0)&&o.a.createElement(R,{images:l,videos:m}),o.a.createElement("div",{className:"ot-post-reactions"},o.a.createElement("small",null,f),o.a.createElement("span",null),o.a.createElement("small",{className:p>0&&p!==u.length?"can-click":"",onClick:function(){u&&p>0&&p!==u.length&&e.onShowComments()}},g)),(u&&u.length>0||a)&&o.a.createElement(H,{comments:u,loading:a,onToggleCommentLiked:e.onToggleCommentLiked}),o.a.createElement(J,{user:t,faved:s,onToggleLiked:e.onToggleLiked,onFocused:function(){console.log("Innerwidth:",window.innerWidth),window.innerWidth<x&&e.onShowComments()},onNewComment:e.onNewComment}))},Q=(n(112),n(44)),Y=n(45),G=n.n(Y),$=(n(134),n(46)),X=function(e){function t(){var e,n;Object(m.a)(this,t);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(n=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={was_setup:!1},n.processImage=function(){var e=Object(l.a)(c.a.mark(function e(t){var a,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object($.a)("\n            export function load(file) {\n                return new Promise((resolve, reject) => {\n                    var reader = new FileReader();\n                    reader.onload = function(e) {\n                        resolve(e.target.result);\n                    }\n                    reader.readAsDataURL(file);\n                });\n            }\n        "),e.next=3,a.load(t);case 3:o=e.sent,n.props.onImageLoaded(o);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentWillReceiveProps",value:function(e){var t=e.image,n=t.file,a=t.src;!this.state.was_setup&&t&&(this.setState({image:t,was_setup:!0}),n?(this.processImage(n),this.uploadImage(n)):a&&this.uploadImage(a))}},{key:"fileUpload",value:function(e,t,n,a){var o=new FormData;o.append(n,t);var s={headers:{"content-type":"multipart/form-data"},params:a};return Object(f.post)(e,o,s)}},{key:"uploadImage",value:function(e){var t=this,n={token:this.props.token};this.fileUpload(M+"/upload_post_images/",e,"photo",n).then(function(e){var n=e.data.images[0];console.log("Upload image result: ",n),t.props.onImageUploaded(n)}).catch(function(e){var t="";t=e.response?e.response.data:e.request?e.request:e.message,console.error("Upload image Error",t)})}},{key:"render",value:function(){var e=this.props.image,t=e.id,n=e.src,a=e.photo,s=e.loading,i=-1!==t.toString().indexOf("ot-temp-id");return o.a.createElement("div",{className:"ot-new-post-image "+(s?"loading":"")+(i?" is-temp":"")},o.a.createElement("img",{src:n||a,alt:""}),o.a.createElement("button",{className:"ot-btn action",onClick:this.props.onRemoveImage},o.a.createElement("svg",{viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}))))}}]),t}(o.a.Component),Z=function(e){function t(){var e,n;Object(m.a)(this,t);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(n=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={was_setup:!1},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.video}},{key:"videoUpload",value:function(e,t,n){var a=new FormData;a.append("video",t);var o={headers:{"content-type":"multipart/form-data"},params:n};return Object(f.post)(e,a,o)}},{key:"uploadVideo",value:function(e){var t={token:this.props.token};this.videoUpload(M+"/upload_post_videos/",e,t).then(function(e){var t=e.data;console.log("Upload video result: ",t)}).catch(function(e){var t="";t=e.response?e.response.data:e.request?e.request:e.message,console.error("Upload video Error",t)})}},{key:"render",value:function(){var e=this.props.video,t=(e.id,e.loading);return o.a.createElement("div",{className:"ot-new-post-video "+(t?"loading":"")},o.a.createElement(I,{video:e}),o.a.createElement("button",{className:"ot-btn action",onClick:this.props.onRemoveVideo},o.a.createElement("svg",{viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}))))}}]),t}(o.a.Component),ee=function(e){var t=e.readonly,n=e.images,a=e.videos,s=e.token,i=a&&a.length?a[0]:null;return o.a.createElement("div",{className:"ot-new-post-media"},a&&a.length>0&&o.a.createElement(Z,{video:i,token:s,onVideoUploaded:function(n){t||e.onVideoUploaded(n)},onRemoveVideo:e.onRemoveVideo}),n&&n.length>0&&o.a.createElement("div",{className:"layout ot-new-post-images"},n.map(function(n,a){return o.a.createElement(X,{key:a,image:n,token:s,onImageLoaded:function(o){t||e.onImageLoaded(n,a,o)},onImageUploaded:function(o){t||e.onImageUploaded(n,a,o)},onRemoveImage:function(){return e.onRemoveImage(a)}})})))},te=function(e){function t(){var e,n;Object(m.a)(this,t);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(n=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={facingMode:"user"},n.setup=function(){var e=n.props,t=(e.video,e.audio);navigator.mediaDevices&&navigator.mediaDevices.getUserMedia({video:{facingMode:n.state.facingMode},audio:t}).then(function(e){n.setState({mediaStream:e}),n.video.srcObject=e,n.video.play()}).catch(function(e){return e})},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentWillMount",value:function(){this.setup()}},{key:"componentWillUnmount",value:function(){this.state.mediaStream.getVideoTracks()[0].stop()}},{key:"capture",value:function(){var e=this.state.mediaStream.getVideoTracks()[0];return new window.ImageCapture(e).takePhoto()}},{key:"switchMode",value:function(){var e=this,t="environment"===this.state.facingMode?"user":"environment";this.setState({facingMode:t},function(){e.state.mediaStream.getVideoTracks()[0].stop(),e.setState({mediaStream:null}),setTimeout(function(){e.setup()})})}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{style:this.props.style},this.props.children,o.a.createElement("video",{ref:function(t){e.video=t}}))}}]),t}(a.Component);te.defaultProps={audio:!1,video:!0,style:{},children:null};var ne=te,ae=function(e){function t(){var e,n;Object(m.a)(this,t);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(n=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={image:null},n.takePicture=function(){n.camera.capture().then(function(e){var t=URL.createObjectURL(e);n.img.src=t,n.setState({image:e}),console.log(t),n.img.onload=function(){URL.revokeObjectURL(n.src)}})},n.switchCameraMode=function(){n.camera.switchMode()},n.handleRepeat=function(){n.setState({image:null})},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.state.image;return o.a.createElement("div",{id:"newPostCamera"},!t&&o.a.createElement(ne,{ref:function(t){e.camera=t}},o.a.createElement("div",{id:"captureContainer"},o.a.createElement("button",{className:"ot-btn flat",onClick:this.props.onCancel},"CANCEL"),o.a.createElement("div",{id:"captureButton",onClick:this.takePicture}),o.a.createElement("button",{className:"ot-btn action",onClick:this.switchCameraMode},o.a.createElement("svg",{viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),o.a.createElement("path",{d:"M20 4h-3.17L15 2H9L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-5 11.5V13H9v2.5L5.5 12 9 8.5V11h6V8.5l3.5 3.5-3.5 3.5z"}))))),o.a.createElement("img",{id:"captureImage",className:t?"":"hidden",ref:function(t){e.img=t},alt:""}),t&&o.a.createElement("div",{id:"captureContainer"},o.a.createElement("button",{className:"ot-btn flat",onClick:this.handleRepeat},"REPEAT"),o.a.createElement("button",{className:"ot-btn flat",onClick:function(){return e.props.onAddPicture(t)}},"CONTINUE")))}}]),t}(a.Component),oe=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={takingPicture:!1},n.closeCamera=function(){n.props.onCloseCamera(),n.inputField&&n.inputField.current.textarea.focus()},n.handleAddPicture=function(e){n.closeCamera(),n.props.onAddPicture(e)},n.inputField=o.a.createRef(),n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.inputField&&this.inputField.current.textarea.focus()}},{key:"render",value:function(){var e=this.props,t=e.takingPicture,n=e.posting,a=e.editting,s=e.user,i=e.content,r=e.videos,c=e.images;return o.a.createElement(o.a.Fragment,null,t&&o.a.createElement(G.a,{enabled:t},o.a.createElement(ae,{onCancel:this.closeCamera,onAddPicture:this.handleAddPicture})),o.a.createElement("div",{className:"ot-new-post-mobile "+(n?"posting ":" ")+(n&&a?"saving ":" ")},o.a.createElement("div",{className:"ot-new-post-mobile-nav layout center"},o.a.createElement("button",{className:"ot-btn action",onClick:this.props.onBackClicked},o.a.createElement("svg",{viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"}))),o.a.createElement("span",null,a?"Edit":"New"," Post"),o.a.createElement("span",{className:"flex"}),o.a.createElement("button",{className:"ot-btn flat",onClick:this.props.onSubmitClicked},a?"SAVE":"SUBMIT")),o.a.createElement("div",{className:"ot-new-post-mobile-content"},o.a.createElement("div",{className:"ot-new-post-wrapper layout"},o.a.createElement("div",{className:"ot-dp"},o.a.createElement("img",{src:s.dp,alt:""})),o.a.createElement(z.a,{ref:this.inputField,placeholder:"Share your inisights...",className:"ot-new-post-text",rows:1,value:i,onChange:this.props.onChange,onKeyUp:this.props.onKeyUp})),o.a.createElement(ee,{readonly:!0,token:s.token,videos:r,images:c,onRemoveImage:this.props.onRemoveImage,onRemoveVideo:this.props.onRemoveVideo})),r.length<1&&o.a.createElement("div",{className:"ot-new-post-mobile-actions layout center-center"},o.a.createElement("input",{type:"file",id:"mobileImages",onChange:this.props.onFilesPicked}),o.a.createElement("label",{className:"ot-btn flat",htmlFor:"mobileImages"},"ADD FILES"),"\u2003\u2003",o.a.createElement("button",{className:"ot-btn flat",onClick:this.props.onOpenCamera},"TAKE PICTURE"))))}}]),t}(o.a.Component),se=5,ie=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={creatingOnMobile:!1,takingPicture:!1,posting:!1,dragover:!1,focused:!1,post_id:null,content:"",images:[],videos:[]},n.FileDragHover=function(e){if(e.stopPropagation(),e.preventDefault(),!n.state.videos.length){var t="dragleave"!==e.type&&"drop"!==e.type;setTimeout(function(){n.setState({dragover:t})},20)}},n.FileSelectHandler=function(e){if(n.state.videos.length)return w(k("You can not upload both videos and images"));n.FileDragHover(e);var t=e.target.files||e.dataTransfer.files;t&&t.length&&n.processFiles(t)},n.openCamera=function(){console.log("Opening camera...."),window.history.pushState({takingPicture:!0},"takingPicture","#creatingOnMobile/takingPicture"),n.setState({takingPicture:!0})},n.closeCamera=function(){window.history.back(),n.setState({takingPicture:!1})},n.imageLoaded=function(e,t,a){var o=Object(v.a)(n.state.images);e.src=a,e.loading=!1,o.splice(t,1,e),n.setState({images:o})},n.imageUpLoaded=function(e,t,a){var o=Object(v.a)(n.state.images);e.id=a.id,e.photo=a.photo,o.splice(t,1,e),n.setState({images:o})},n.videoUpLoaded=function(e){var t=Object(v.a)(n.state.videos)[0];t.id=e.id,n.setState({videos:[t]})},n.removeVideo=function(){n.setState({videos:[]})},n.removeImage=function(e){var t=Object(v.a)(n.state.images);t.splice(e,1),n.setState({images:t})},n.handleAddPicture=function(e){if(n.state.images.length!==se){var t="ot-temp-id"+Math.random().toString(36).substr(2,5);e.lastModifiedDate=new Date,e.name="ot-file-"+Math.random().toString(36).substr(2,5),n.setState({images:Object(v.a)(n.state.images).concat([{id:t,file:e,loading:!0,src:""}])})}else w(k("You can not upload more than ".concat(se," images")))},n.processFiles=function(e){var t=Array.from(e).filter(function(e){return-1!==e.type.indexOf("image")}).map(function(e){return{id:"ot-temp-id"+Math.random().toString(36).substr(2,5),file:e,loading:!0,src:""}}),a=se-n.state.images.length;a<0&&(a=0),a<t.length&&w(k("You can not upload more than ".concat(se," images"))),n.setState({images:n.state.images.concat(Object(Q.slice)(t,0,a))}),Array.from(e).filter(function(e){return-1===e.type.indexOf("image")}).forEach(function(e){var t=e.name.substr(0,15).trim();t+=e.name.length>15?"...":"",w(k("<strong>".concat(t,"</strong> is not an image")))})},n.setFocus=function(e,t){t||n.setState({focused:e}),e&&t&&window.innerWidth<x&&n.openMobileCreate()},n.openMobileCreate=function(){window.history.pushState({creating:!0},"creating","#creatingOnMobile"),n.setState({creatingOnMobile:!0})},n.closeMobileCreate=function(){window.history.back(),n.setState({creatingOnMobile:!1}),n.state.post_id&&n.props.onCancelEditting()},n.handleChange=function(e){var t=e.target.value,a=t.indexOf("https"),o=t.substr(a,t.length);n.setState({content:t},function(){if(-1!==a&&T(o)){var e=[{id:"ot-temp-id"+Math.random().toString(36).substr(2,5),video:o}];t=t.replace(o,""),n.setState({content:t,videos:e})}})},n.handleKeyup=function(e){"Enter"===e.key&&n.state.content.length&&n.submitClicked()},n.sendPost=function(e,t,n){var a={headers:{"content-type":"application/x-www-form-urlencode"},params:n};return Object(f.post)(e,t,a)},n.submitClicked=Object(l.a)(c.a.mark(function e(){var t,a,o,s;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.setState({posting:!0}),(t=new FormData).append("content",n.state.content),!n.state.images.length){e.next=6;break}return e.next=6,n.state.images.map(function(e){return e.photo=e.file,console.log(e.id),t.append("photo_list",e.id),e.id});case 6:n.state.videos.length&&!n.state.images.length&&(a=n.state.videos[0],t.set("content",n.state.content+a.video)),o={token:n.props.user.token},s=M+(n.state.post_id?"/edit_post":"/publish_post/"),n.state.post_id&&t.append("id",n.state.post_id),n.sendPost(s,t,o).then(function(e){var t=e.data;n.setState({posting:!1});var a=t[0];console.log("Submit post result: ",a),a.status&&(n.props.onNewPost(a.post),n.state.creatingOnMobile&&n.closeMobileCreate(),n.setState({posting:!1,dragover:!1,focused:!1,content:"",images:[],videos:[]}))}).catch(function(e){n.setState({posting:!1}),w(k("Error submitting post"));var t="";t=e.response?e.response.data:e.request?e.request:e.message,console.error("Submit post Error",t)});case 11:case"end":return e.stop()}},e,this)})),n.wrapper=o.a.createRef(),n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;if(this.props.post){var t=this.props.post,n=t.id,a=t.content,o=t.images,s=t.videos;this.setState({post_id:n,content:a,images:o,videos:s},function(){window.innerWidth<x&&e.openMobileCreate()})}window.addEventListener("dragover",this.FileDragHover,!1),window.addEventListener("dragleave",this.FileDragHover,!1),window.addEventListener("drop",this.FileSelectHandler,!1),this._isMounted=!0,document.addEventListener("ot-popstate",function(t){if(e._isMounted){var n=window.location.hash;console.log("Popstate hash: ",n,n.indexOf("creatingOnMobile")),-1===n.indexOf("creatingOnMobile")&&e.state.creatingOnMobile&&(e.setState({creatingOnMobile:!1}),e.state.post_id&&e.props.onCancelEditting()),-1===n.indexOf("takingPicture")&&e.state.takingPicture&&e.setState({takingPicture:!1})}},!1)}},{key:"render",value:function(){var e=this,t=this.props.user,n=this.state,a=n.creatingOnMobile,s=n.takingPicture,i=n.posting,r=n.post_id,c=n.dragover,l=n.focused,m=n.content,u=n.images,d=n.videos,p=i&&r;(u.length||d.length)&&u.length;return o.a.createElement(o.a.Fragment,null,a&&o.a.createElement(oe,{user:t,content:m,images:u,videos:d,takingPicture:s,posting:i,editting:null!=r,onChange:this.handleChange,onKeyUp:this.handleKeyup,onFilesPicked:this.FileSelectHandler,onRemoveImage:this.removeImage,onRemoveVideo:this.removeVideo,onSubmitClicked:this.submitClicked,onBackClicked:this.closeMobileCreate,onOpenCamera:this.openCamera,onCloseCamera:this.closeCamera,onAddPicture:this.handleAddPicture}),o.a.createElement("div",{ref:this.wrapper,className:"ot-new-post "+(p?"saving ":" ")+(i?"posting ":" ")+(c?u.length?"dragging has-images":"dragging":"")},o.a.createElement("div",{className:"ot-new-post-wrapper layout"},o.a.createElement("div",{className:"ot-dp"},o.a.createElement("img",{src:t.dp,alt:""})),o.a.createElement(z.a,{placeholder:"Share your inisights...",className:"ot-new-post-text",rows:1,onClick:function(){return e.setFocus(!0,!0)},onFocus:function(){return e.setFocus(!0)},onBlur:function(){return e.setFocus(!1)},onChange:this.handleChange,onKeyUp:this.handleKeyup,value:m})),o.a.createElement(ee,{token:t.token,videos:d,images:u,onImageLoaded:this.imageLoaded,onImageUploaded:this.imageUpLoaded,onRemoveImage:this.removeImage,onVideoUploaded:this.videoUpLoaded,onRemoveVideo:this.removeVideo}),o.a.createElement("div",{className:"layout end-justified ot-new-post-button-wrapper"+(m.length||l?" visible":"")},o.a.createElement("button",{className:"ot-btn flat"+(m.length?"":" disabled"),onClick:this.submitClicked},r?"SAVE":"POST"))),o.a.createElement("button",{className:"ot-btn fab ot-post-creator-fab",onClick:this.openMobileCreate},o.a.createElement("svg",{viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}))))}}]),t}(o.a.Component),re=(n(136),function(e){var t=e.thin;return o.a.createElement("div",{className:"ot-loader "+(t?"thin":"")},o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null))}),ce=(n(138),function(e){function t(){return Object(m.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.post,n=e.user;return o.a.createElement("div",{className:"ot-edit-post-wrapper"},o.a.createElement("div",{className:"ot-edit-post"},o.a.createElement("div",{className:"ot-edit-post-title layout center justified"},"Edit Post",o.a.createElement("button",{className:"ot-btn action",onClick:this.props.onCancelEditting},o.a.createElement("svg",{viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})))),o.a.createElement(ie,{post:t,user:n,onNewPost:this.props.onNewPost,onCancelEditting:this.props.onCancelEditting})))}}]),t}(o.a.Component)),le=(n(140),function(e){function t(){var e,n;Object(m.a)(this,t);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(n=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={fetching_comments:!0,comments:[]},n.toggleCommentLiked=function(e){var t=Object(v.a)(n.state.comments),a=JSON.parse(JSON.stringify(t[e])),o=a.is_liked;a.is_liked=!o,t.splice(e,1,a),n.setState({comments:t});var s=n.props.user,i=M+(o?"/unlike_comment/":"/like_comment/"),r={token:s.token,comment_id:a.id};g.a.get(i,{params:r}).then(function(s){var i=s.data[0];console.log("Toggle Comment like response",i),i.status?n.props.onToggleCommentLike(e,!o):(a.is_liked=o,t.splice(e,1,a),n.setState({comments:t}))}).catch(function(s){console.error("Toggle comment like Error",s),a.is_liked=o,t.splice(e,1,a),n.setState({comments:t})})},n.addComment=function(e){var t=n.props,a=t.post,o=t.user,s={id:"ot-temp-id"+Math.random().toString(36).substr(2,5),content:e,published_at:new Date,is_liked:!1,publisher:n.props.user},i=Object(v.a)(n.state.comments),r=i.length;i.push(s),n.setState({comments:i});var c={token:o.token},l=new FormData;l.append("content",e),l.append("post_id",a.id),g()({method:"POST",url:M+"/publish_comment/",headers:{"content-type":"application/x-www-form-urlencode"},params:c,data:l}).then(function(e){var t=e.data[0];console.log("Comment result: ",t),t.status?(s.id=s.id.replace("ot-temp-id",""),i.splice(r,1,s),n.props.onNewComment(s)):(a.total_comments-=1,a.total_commenets-=1,i.splice(r,1)),n.setState({comments:i})}).catch(function(e){var t="";t=e.response?e.response.data:e.request?e.request:e.message,console.error("Comment Error",t),i.splice(r,1),n.setState({comments:i})})},n.fetchComments=function(){var e=n.props,t=e.user,a=e.post,o={token:t.token,post_id:a.id};g.a.get(M+"/comments/",{params:o}).then(function(e){console.log("Post Comments result: ",e,200===e.status),200===e.status&&n.setState({comments:e.data}),n.setState({fetching_comments:!1})}).catch(function(e){var t="";t=e.response?e.response.data:e.request?e.request:e.message,console.error("Post Comments Error",t),n.setState({fetching_comments:!1})})},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;window.history.pushState({commentingOnMobile:!0},"commentingOnMobile","#commentingOnMobile"),document.addEventListener("ot-popstate",function(t){var n=window.location.hash;console.log("commentingOnMobile Popstate hash: ",n,n.indexOf("commentingOnMobile")),-1===n.indexOf("commentingOnMobile")&&e.props.onCancelCommenting()},!1),this.fetchComments()}},{key:"render",value:function(){var e=this.props,t=e.user,n=e.post,a=this.state,s=a.fetching_comments,i=a.comments;return o.a.createElement("div",{className:"ot-post-comments-mobile"},o.a.createElement("div",{className:"ot-post-comments-mobile-nav layout center"},o.a.createElement("button",{className:"ot-btn action",onClick:function(){return window.history.back()}},o.a.createElement("svg",{viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"}))),o.a.createElement("span",null,"Post Comments")),o.a.createElement("div",{className:"ot-post-comments-mobile-content"},o.a.createElement(H,{comments:i,loading:s,onToggleCommentLiked:this.toggleCommentLiked})),o.a.createElement("div",{className:"ot-post-comments-mobile-actions"},o.a.createElement(J,{user:t,faved:n.is_liked,autofocus:!0,quickemojis:!0,onNewComment:this.addComment})))}}]),t}(o.a.Component)),me=function(e){function t(){var e,n;Object(m.a)(this,t);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(n=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={initial_fetch:!1,fetching:!1,page:1,postToEdit:null,postToComment:null,posts:[]},n.fetchUserPosts=function(){n.setState({fetching:!0});var e={token:n.state.token,page:n.state.page};g.a.get(M+"/wall/",{params:e}).then(function(e){var t=e.data;console.log("Fetch posts result",t),n.setState({posts:Object(v.a)(n.state.posts).concat(Object(v.a)(t)),fetching:!1,initial_fetch:!0,page:n.state.page+1})}).catch(function(e){console.error("Fetch posts Error",e),n.setState({initial_fetch:!0,fetching:!1})})},n.toggleCommentLiked=function(e,t,a){var o=JSON.parse(JSON.stringify(e.comments[a])),s=o.is_liked,i=Object(v.a)(n.state.posts);o.is_liked=!s,e.comments.splice(a,1,o),i.splice(t,1,e),n.setState({posts:i});var r=M+(s?"/unlike_comment/":"/like_comment/"),c={token:n.state.token,comment_id:o.id};g.a.get(r,{params:c}).then(function(r){var c=r.data[0];console.log("Toggle Comment like response",c),c.status||(o.is_liked=s,e.comments.splice(a,1,o),i.splice(t,1,e),n.setState({posts:i}))}).catch(function(r){console.error("Toggle comment like Error",r),o.is_liked=s,e.comments.splice(a,1,o),i.splice(t,1,e),n.setState({posts:i})})},n.setCommentLiked=function(e,t,a,o){var s=JSON.parse(JSON.stringify(e.comments[a])),i=Object(v.a)(n.state.posts);s.is_liked=o,e.comments.length<a||(e.comments.splice(a,1,s),i.splice(t,1,e),n.setState({posts:i}))},n.toggleLiked=function(e,t){var a=e.is_liked,o=Object(v.a)(n.state.posts);e.is_liked=!a,e.total_likes+=a?-1:1,o.splice(t,1,e),n.setState({posts:o});var s=M+(a?"/unlike_post/":"/like_post/"),i={token:n.state.token,post_id:e.id};g.a.get(s,{params:i}).then(function(s){s.data[0].status||(e.is_liked=a,o.splice(t,1,e),n.setState({posts:o}))}).catch(function(s){console.error("Toggle like Error",s),e.is_liked=a,o.splice(t,1,e),n.setState({posts:o})})},n.newPost=function(e){var t=Object(v.a)(n.state.posts);t.unshift(e),console.log(e,t),w(k("Your post has been submitted")),n.setState({posts:t})},n.addComment=function(e,t,a){var o=Object(P.a)({},e).comments.length;console.log(e.comments.length),e.total_comments+=1,e.total_commenets+=1;var s={id:"ot-temp-id"+Math.random().toString(36).substr(2,5),content:a,published_at:new Date,is_liked:!1,publisher:n.props.user};e.comments.push(s);var i=Object(v.a)(n.state.posts);i.splice(t,1,e),n.setState({posts:i});var r={token:n.state.token},c=new FormData;c.append("content",a),c.append("post_id",e.id),g()({method:"POST",url:M+"/publish_comment/",headers:{"content-type":"application/x-www-form-urlencode"},params:r,data:c}).then(function(a){var r=a.data[0];console.log("Comment result: ",r),r.status?s.id=s.id.replace("ot-temp-id",""):(e.comments.splice(o,1),e.total_comments-=1,e.total_commenets-=1),i.splice(t,1,e),n.setState({posts:i})}).catch(function(a){var s="";s=a.response?a.response.data:a.request?a.request:a.message,console.error("Comment Error",s),e.comments.splice(o,1),i.splice(t,1,e),n.setState({posts:i})})},n.addCommentToPost=function(e,t,a){e.total_comments+=1,e.total_commenets+=1,e.comments.push(a);var o=Object(v.a)(n.state.posts);o.splice(t,1,e),n.setState({posts:o})},n.showComments=function(e,t){if(window.innerWidth<x)return n.commentOnMobile(e,t);e.fetching_comments=!0;var a=Object(v.a)(n.state.posts);a.splice(t,1,e),n.setState({posts:a});var o={token:n.state.token,post_id:e.id};g.a.get(M+"/comments/",{params:o}).then(function(o){console.log("Post Comments result: ",o,200===o.status),200===o.status&&(e.comments=o.data),e.fetching_comments=!1,a.splice(t,1,e),console.log(a[0]),n.setState({posts:a})}).catch(function(o){var s="";s=o.response?o.response.data:o.request?o.request:o.message,console.error("Post Comments Error",s),e.fetching_comments=!1,a.splice(t,1,e),n.setState({posts:a})})},n.commentOnMobile=function(e,t){n.setState({postToComment:{post:e,index:t}})},n.cancelCommenting=function(){n.setState({postToComment:null})},n.editPost=function(e,t){n.setState({postToEdit:{post:e,index:t}})},n.savePost=function(e){var t=Object(v.a)(n.state.posts),a=n.state.postToEdit.index;t.splice(a,1,e),n.setState({posts:t})},n.cancelEditPost=function(){n.setState({postToEdit:null})},n.deletePost=function(e,t){var a=Object(v.a)(n.state.posts),o=M+"/delete_post",s={token:n.state.token,post_id:e.id};U("Delete Post","Are you sure you want to delete post","Delete",function(e){e&&g.a.get(o,{params:s}).then(function(e){e.data[0].status&&(w(k("Post Deleted")),a.splice(t,1),n.setState({posts:a}))}).catch(function(e){console.error("Delete post Error",e)})})},n.handleReachedBottom=function(e){console.log("ReachedBottom Event",e),e.isIntersecting&&!n.state.fetching&&n.fetchUserPosts()},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.user,a=t.posts;t.readonly?n&&this.setState({posts:a,initial_fetch:!0}):this.setState({token:n.token},function(){e.fetchUserPosts()})}},{key:"render",value:function(){var e=this,t=this.state,n=t.scrolled,a=t.posts,s=t.postToEdit,i=t.postToComment,r=t.initial_fetch,c=t.fetching,l=this.props,m=l.user,u=l.readonly,d={onChange:this.handleReachedBottom,root:"body",rootMargin:"60px 0%"};return o.a.createElement(o.a.Fragment,null,s&&o.a.createElement(ce,{user:m,post:s.post,onNewPost:this.savePost,onCancelEditting:this.cancelEditPost}),i&&o.a.createElement(le,{user:m,post:i.post,onNewComment:function(t){return e.addCommentToPost(i.post,i.index,t)},onToggleCommentLike:function(t,n){return e.setCommentLiked(i.post,i.index,t,n)},onCancelCommenting:this.cancelCommenting}),o.a.createElement("div",{className:"ot-post-list-wrapper "+(n?"scrolled":"")},!u&&o.a.createElement(ie,{user:m,onNewPost:this.newPost}),o.a.createElement("div",{className:"ot-post-list"},r&&a.map(function(t,n){return o.a.createElement(K,{key:t.id,post:t,user:m,onToggleLiked:function(){return e.toggleLiked(t,n)},onNewComment:function(a){return e.addComment(t,n,a)},onToggleCommentLiked:function(a){return e.toggleCommentLiked(t,n,a)},onShowComments:function(){return e.showComments(t,n)},onEditPost:function(){return e.editPost(t,n)},onDeletePost:function(){return e.deletePost(t,n)},onViewUser:function(){return e.props.onViewUser(t.publisher)}})})),c&&o.a.createElement("div",{className:"layout center-justified"},o.a.createElement(re,null)),o.a.createElement(L.a,d,o.a.createElement("div",{style:{height:"20px"},className:"layout center-justified"}))))}}]),t}(o.a.Component),ue=(n(142),function(e){return o.a.createElement("div",{className:"ot-header layout center"},e.children)}),de=function(e){function t(){return Object(m.a)(this,t),Object(d.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.user,n=e.onViewProfile,a=e.onViewUser;return o.a.createElement(o.a.Fragment,null,o.a.createElement(ue,null,o.a.createElement("img",{className:"ot-logo",src:_.a,alt:""}),"\u2003",o.a.createElement("span",{className:"ot-header-title"},"Otalk"),o.a.createElement("span",{className:"flex"}),o.a.createElement("div",{className:"ot-dp"},o.a.createElement("img",{src:t.dp,alt:"",onClick:n}))),o.a.createElement(me,{user:t,onViewUser:a}))}}]),t}(o.a.Component),pe=(n(144),function(e){function t(){var e,n;Object(m.a)(this,t);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(n=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={user:{},profileLoaded:!1,postsLoaded:!1},n.fetchUserProfile=function(){var e=n.props,t=e.user,a={token:e.sessionUser.token,user_id:t.id};g.a.get(M+"/profile/",{params:a}).then(function(e){var t=e.data,a=t[0];console.log("Fetch user profile result",t),n.setState({profileLoaded:!0,user:Object(P.a)({},n.state.user,a.user)})}).catch(function(e){console.error("Fetch user profile Error",e),n.setState({initial_fetch:!0})})},n.fetchUserPosts=function(){var e=n.props,t=e.user,a={token:e.sessionUser.token,user_id:t.id};g.a.get(M+"/user_wall/",{params:a}).then(function(e){var t=e.data;console.log("Fetch user posts result",t),n.props.onPostsLoaded&&n.props.onPostsLoaded(),n.setState({postsLoaded:!0,user:Object(P.a)({},n.state.user,{posts:t})})}).catch(function(e){console.error("Fetch user posts Error",e)})},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.setState({user:this.props.user}),this.fetchUserProfile(),this.fetchUserPosts()}},{key:"render",value:function(){var e=this.props.sessionUser,t=this.state,n=t.user,a=t.profileLoaded,s=t.postsLoaded,i=!a&&!s,r=n.display_name,c=n.dp,l=n.posts;return o.a.createElement("div",{className:"ot-user-profile"},o.a.createElement("div",{className:"ot-user-profile-title layout vertical center"},o.a.createElement("div",{className:"ot-dp"},o.a.createElement("img",{src:c,alt:""})),o.a.createElement("h5",null,r),e.id===n.id&&o.a.createElement("button",{className:"ot-btn logout-btn",onClick:this.props.onLogout},"LOGOUT"),i&&o.a.createElement(re,{thin:!0}),a&&o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"user-stats layout center-center"},o.a.createElement("div",{className:"user-stat"},o.a.createElement("div",{className:"number"},n.followers),o.a.createElement("div",{className:"label"},"Followers")),o.a.createElement("div",{className:"user-stat"},o.a.createElement("div",{className:"number"},n.following),o.a.createElement("div",{className:"label"},"Following")),o.a.createElement("div",{className:"user-stat"},o.a.createElement("div",{className:"number"},n.friends),o.a.createElement("div",{className:"label"},"Friends"))),e.id!==n.id&&o.a.createElement("button",{className:"ot-btn fla"},"FOLLOW"))),s&&o.a.createElement(me,{readonly:!0,user:e,posts:l}))}}]),t}(o.a.Component)),he=(n(146),function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={visible:!1,closing:!1,fixed:!1},n.handleIntersection=function(e){console.log("Intersection Event",e),e.isIntersecting?n.setState({fixed:!0}):n.setState({fixed:!1})},n.handleClose=function(){window.history.back()},n.closeBottomSheet=function(){setTimeout(function(){n.props.onClose&&n.props.onClose()},350)},n.contentWrapper=o.a.createRef(),n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({visible:!0});var t=this.props.id;window.history.pushState(Object(O.a)({},t,!0),t,"#"+t),document.addEventListener("ot-popstate",function(n){var a=window.location.hash;console.log("State was popped yo!",a,a.indexOf(t)),-1===a.indexOf(t)&&e.state.visible&&(e.contentWrapper&&e.contentWrapper.current&&(e.contentWrapper.current.scrollTop=0),e.setState({closing:!0},function(){e.closeBottomSheet()}))},!1)}},{key:"render",value:function(){var e={onChange:this.handleIntersection,root:".ot-bottom-sheet",rootMargin:"0% 0% -".concat(window.innerHeight,"px")},t=this.state,n=t.visible,a=t.fixed,s=t.closing,i=this.props,r=i.contentLoaded,c=i.peekHeight;c||(c=300);var l=window.innerHeight-(c+32);return o.a.createElement("div",{className:"ot-bottom-sheet "+(n?"visible ":"")+(a?"fixed ":"")+(r?"content-loaded ":"")+(s?"closing":"")},o.a.createElement("div",{className:"ot-bottom-sheet-bg",onClick:this.handleClose}),o.a.createElement(L.a,e,o.a.createElement("div",{ref:this.contentWrapper,className:"ot-bottom-sheet-content",style:{transform:"translateY( ".concat(l,"px)")}},o.a.createElement("button",{className:"ot-btn action back-btn",onClick:this.handleClose},o.a.createElement("svg",{viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}))),this.props.children)))}}]),t}(o.a.Component)),fe=function(e){function t(){var e,n;Object(m.a)(this,t);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return(n=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={user:{},profileUser:null,userProfilePostsLoaded:!1,user_fetched:!1},n.fetchUser=Object(l.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,localStorage.getItem("ot-user");case 2:t=e.sent,n.setState({user_fetched:!0}),null!=t&&n.setState({user:JSON.parse(t)});case 5:case"end":return e.stop()}},e,this)})),n.handleProfilePostsLoaded=function(){n.setState({userProfilePostsLoaded:!0})},n.login=function(e){var t={username:e.username,password:e.password};g()({method:"POST",url:"https://www.olbongo.com/api/login/",params:t}).then(function(e){var t=e.data;if(t.status){var a=t.user,o=t.token;a.token=o,localStorage.setItem("ot-user",JSON.stringify(a)),n.setState({user:a})}else w(k("Wrong credentials!"))}).catch(function(e){console.error("Login Error",e),w(k("Wrong credentials!"))})},n.logout=function(){localStorage.removeItem("ot-user"),n.setState({profileUser:null,user_fetched:!0,user:null})},n.closeProfileUser=function(){n.setState({profileUser:null})},n.viewProfileUser=function(e){window.innerWidth<541?n.setState({profileUser:e}):n.logout()},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentWillMount",value:function(){this.fetchUser()}},{key:"componentDidMount",value:function(){this._isMounted=!0,window.onpopstate=function(){document.dispatchEvent(new CustomEvent("ot-popstate")),console.log("State popped!")}}},{key:"render",value:function(){var e=this,t=this.state,n=t.user,a=t.user_fetched,s=t.profileUser,i=t.userProfilePostsLoaded,r=n&&n.id&&n.token;return o.a.createElement("div",{className:"ot-app-wrapper",context:"counter1"},o.a.createElement(C,null),o.a.createElement("main",null,!r&&a&&o.a.createElement(N,{user:n,onLogin:this.login}),r&&o.a.createElement(o.a.Fragment,null,o.a.createElement(de,{user:n,onViewProfile:function(){return e.viewProfileUser(n)},onViewUser:this.viewProfileUser}),s&&o.a.createElement(he,{id:"profileUser",contentLoaded:i,peekHeight:320,onClose:this.closeProfileUser},o.a.createElement(pe,{onLogout:this.logout,onPostsLoaded:this.handleProfilePostsLoaded,sessionUser:n,user:s})))))}}]),t}(o.a.Component),ge=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ve(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}i.a.render(o.a.createElement(fe,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL(".",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat(".","/service-worker.js");ge?(function(e,t){fetch(e).then(function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):ve(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):ve(t,e)})}}()},41:function(e,t,n){e.exports=n.p+"static/media/logo.43803f22.png"},42:function(e,t,n){e.exports=n.p+"static/media/logo.43803f22.png"},48:function(e,t,n){e.exports=n(148)},55:function(e,t,n){},76:function(e,t,n){},78:function(e,t,n){},83:function(e,t,n){},85:function(e,t,n){},87:function(e,t,n){},89:function(e,t,n){},91:function(e,t,n){}},[[48,2,1]]]);
//# sourceMappingURL=main.380ad263.chunk.js.map