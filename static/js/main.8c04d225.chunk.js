(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{103:function(e,t,a){},105:function(e,t,a){},131:function(e,t,a){},133:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),s=a(38),i=a.n(s),r=a(11),c=a.n(r),l=a(15),m=a(1),u=a(2),d=a(4),p=a(3),h=a(5),g=(a(54),a(8)),f=a.n(g),v=a(6),b=(a(75),a(46)),E=function(e){var t=e.notification,a=t.message;Object(b.a)(t,["message"]);return o.a.createElement("div",{className:"notif show",dangerouslySetInnerHTML:{__html:a}})},w=function(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];var o=a&&a.length?a[0]:{};return new CustomEvent("ot-notification",{detail:{message:e,options:o}})},k=function(e){document.dispatchEvent(e)},C=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={notifications:[]},a.showNotification=function(e){a.setState({notifications:Object(v.a)(a.state.notifications).concat([e])},function(){setTimeout(function(){var t=Object(v.a)(a.state.notifications).filter(function(t){return t.id!==e.id});a.setState({notifications:t})},3e3)})},a.wrapper=o.a.createRef(),a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("ot-notification",function(t){var a=t.detail;a.id="ot-notif-"+Math.random().toString(36).substr(2,5),e.showNotification(a)},!1)}},{key:"render",value:function(){var e=this.state.notifications;return o.a.createElement("div",{className:"ot-notifications-wrapper"},e.reverse().map(function(e,t){return o.a.createElement(E,{key:t,notification:e})}))}}]),t}(o.a.Component),y=a(16),O=(a(77),a(39)),N=a.n(O),S=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(a=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={username:"",password:""},a.inputChanged=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.username,n=t.password,s=a.length>0&&n.length>0;return o.a.createElement("div",{className:"ot-login-page"},o.a.createElement("form",{className:"ot-login-form",autoComplete:"off"},o.a.createElement("div",{className:"ot-login-title layout center"},o.a.createElement("img",{src:N.a,height:"50px",alt:""}),"Otalk Login"),o.a.createElement("div",{className:"ot-input-box"},o.a.createElement("input",{autoFocus:!0,autoComplete:"off",id:"username",className:a.length?"valid":"",required:!0,type:"text",name:"username",value:a,onChange:this.inputChanged}),o.a.createElement("label",{htmlFor:"username"},"Username")),o.a.createElement("div",{className:"ot-input-box"},o.a.createElement("input",{autoComplete:"off",id:"password",className:n.length?"valid":"",required:!0,type:"password",name:"password",value:n,onChange:this.inputChanged}),o.a.createElement("label",{htmlFor:"password"},"Password")),o.a.createElement("button",{type:"button",className:"ot-btn primary rounded "+(s?"":"disabled"),onClick:function(){return e.props.onLogin({username:a,password:n})}},"LOGIN")))}}]),t}(o.a.Component),j=a(40),_=a.n(j),M=(a(79),function(e){var t=e.dp;return o.a.createElement("div",{className:"ot-header layout center"},o.a.createElement("img",{className:"ot-logo",src:_.a,alt:""}),"\u2003",o.a.createElement("span",{className:"ot-header-title"},"Otalk"),o.a.createElement("span",{className:"flex"}),o.a.createElement("div",{className:"ot-dp"},o.a.createElement("img",{src:t,alt:"",onClick:e.onViewProfile})))}),L=a(41),P=(a(81),"https://www.olbongo.com/api/otalk"),F=(a(83),a(85),function(e){var t=e.images,a="",n="";return t.length>1&&(a=t.length>2?"three-image":"two-image",a+="-grid",t.length>3&&(a+=" has-more"),n=t.length>4?t.length-4:""),o.a.createElement("div",{className:"ot-post-images "+a,extras:n},t.slice(0,4).map(function(e){return o.a.createElement("div",{key:e.id,className:"ot-post-image"},o.a.createElement("img",{src:e.photo,alt:""}))}))});function x(e){if(/(http|https):\/\/(\w+:{0,1}\w*)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%!\-\/]))?/.test(e)){return e.match(/^.*(youtu\.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/)}return!1}var I=function(e){var t=e.videos,a=t.length?t[0]:null,n=!!t.length&&x(a.video),s="";return n&&(s=function(e){return"https://www.youtube.com/embed/".concat(e,"?rel=0&amp;showinfo=0")}(n[2])),o.a.createElement("div",{className:"ot-post-video "+(n?"for-youtube":"")},n&&o.a.createElement("iframe",{title:"post video",src:s,frameBorder:"0",allow:"autoplay; encrypted-media",allowFullScreen:!0}),a&&!n&&o.a.createElement("video",{controls:!0},o.a.createElement("source",{src:a.video})))},T=function(e){var t=e.images,a=e.videos;return o.a.createElement("div",{className:"ot-post-media"},t.length>0&&o.a.createElement(F,{images:t}),!t.length&&a.length>0&&o.a.createElement(I,{videos:a}))},U=(a(87),function(){return o.a.createElement("svg",{fill:"#ffa200",className:"ot-post-like-icon",viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),o.a.createElement("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"}))}),A=function(){return o.a.createElement("svg",{fill:"#656565",viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),o.a.createElement("path",{d:"M16.5 3c-1.74 0-3.41.81-4.5 2.09C10.91 3.81 9.24 3 7.5 3 4.42 3 2 5.42 2 8.5c0 3.78 3.4 6.86 8.55 11.54L12 21.35l1.45-1.32C18.6 15.36 22 12.28 22 8.5 22 5.42 19.58 3 16.5 3zm-4.4 15.55l-.1.1-.1-.1C7.14 14.24 4 11.39 4 8.5 4 6.5 5.5 5 7.5 5c1.54 0 3.04.99 3.57 2.36h1.87C13.46 5.99 14.96 5 16.5 5c2 0 3.5 1.5 3.5 3.5 0 2.89-3.14 5.74-7.9 10.05z"}))},R=function(e){return o.a.createElement(o.a.Fragment,null,e.faved?o.a.createElement(U,{key:"favorited_icon"}):o.a.createElement(A,{key:"favorite_icon"}))},D=function(e){var t=e.comment,a=t.id,n=(t.published_at,t.publisher),s=t.content,i=t.is_liked,r=n.dp,c=n.display_name;return o.a.createElement("div",{className:"ot-post-comment layout "+(-1!==a.toString().indexOf("ot-temp-id")?"temp":"")},o.a.createElement("div",{className:"ot-dp small"},o.a.createElement("img",{src:r,alt:""})),o.a.createElement("p",null,o.a.createElement("strong",null,c)," ",s),o.a.createElement("button",{className:"ot-comment-liker ot-btn action",onClick:e.onToggleLiked},o.a.createElement(R,{faved:i})))},H=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(a=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={initial_fetch:!1,comments:[]},a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.comments;e.loading;this.setState({comments:t})}},{key:"render",value:function(){var e=this,t=this.state,a=t.comments,n=t.initial_fetch,s=this.props.loading;return o.a.createElement("div",{className:"ot-post-comments"},!a.length>0&&!n&&o.a.createElement("span",null,"Fetching comments...."),(a.length>0||n)&&o.a.createElement(o.a.Fragment,null,a.map(function(t,a){return o.a.createElement(D,{key:t.id,comment:t,onToggleLiked:function(){return e.props.onToggleCommentLiked(a)}})})),s&&o.a.createElement("span",{className:"ot-comments-loader"},a.length>0?"loading more comments....":"loading comments...."))}}]),t}(o.a.Component),B=a(42),z=(a(103),function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).handleChange=function(e){a.setState({comment:e.target.value})},a.handleKeyup=function(e){"Enter"===e.key&&a.sendComment()},a.sendComment=function(){var e=JSON.parse(JSON.stringify(a.state)).comment;e.length&&(a.props.onNewComment(e),a.setState({comment:""}))},a.state={comment:"",animate_icon:!0},a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state,t=e.comment,a=e.animate_icon,n=this.props,s=n.user,i=n.faved,r=a?500:0;return o.a.createElement("div",{className:"ot-post-commenter layout center"},o.a.createElement("div",{className:"ot-dp small"},o.a.createElement("img",{src:s.dp,alt:""})),o.a.createElement("input",{className:"flex",type:"text",placeholder:"Write a Comment",value:t,onChange:this.handleChange,onKeyUp:this.handleKeyup}),o.a.createElement("div",{className:"ot-post-commenter-actions"+(t.length?"":" can-like")},o.a.createElement("button",{className:"ot-btn flat",onClick:this.sendComment},"POST"),o.a.createElement("button",{className:"ot-post-liker ot-btn action",onClick:this.props.onToggleLiked},o.a.createElement(B.MorphReplace,{width:20,height:20,duration:r,rotation:"none"},i?o.a.createElement(U,{key:"favorited_icon"}):o.a.createElement(A,{key:"favorite_icon"})))))}}]),t}(o.a.Component)),K=function(e){var t=e.user,a=e.post,n=a.fetching_comments,s=a.is_liked,i=a.publisher,r=(a.owned,a.published_at),c=a.content,l=a.images,m=a.videos,u=a.comments,d=a.total_likes,p=a.total_commenets,h=d+" Like";h+=1!=d?"s":"";var g=p+" Comment";return g+=1!=p?"s":"",o.a.createElement("div",{className:"ot-post-item"},o.a.createElement("div",{className:"ot-post-item-title layout center"},o.a.createElement("div",{className:"ot-dp"},o.a.createElement("img",{src:i.dp,alt:""})),o.a.createElement("div",null,o.a.createElement("span",{className:"ot-post-item-owner"},i.display_name),o.a.createElement("span",{className:"ot-post-item-date"},r)),o.a.createElement("span",{className:"flex"}),o.a.createElement("button",{className:"ot-post-options-btn ot-btn action"},o.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),o.a.createElement("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"})))),o.a.createElement("p",{className:"ot-post-item-content"},c),(l.length>0||m.length>0)&&o.a.createElement(T,{images:l,videos:m}),o.a.createElement("div",{className:"ot-post-reactions"},o.a.createElement("small",null,h),o.a.createElement("span",null),o.a.createElement("small",{className:p>0?"can-click":"",onClick:function(){u&&p>0&&p!==u.length&&e.onShowComments()}},g)),(u&&u.length>0||n)&&o.a.createElement(H,{comments:u,loading:n,onToggleCommentLiked:e.onToggleCommentLiked}),o.a.createElement(z,{user:t,faved:s,onToggleLiked:e.onToggleLiked,onNewComment:e.onNewComment}))},q=(a(105),a(43)),V=a(17),W=a.n(V),J=a(44),Y=a.n(J),G=(a(131),a(45)),$=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(a=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={was_setup:!1},a.processImage=function(){var e=Object(l.a)(c.a.mark(function e(t){var n,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(G.a)("\n            export function load(file) {\n                return new Promise((resolve, reject) => {\n                    var reader = new FileReader();\n                    reader.onload = function(e) {\n                        resolve(e.target.result);\n                    }\n                    reader.readAsDataURL(file);\n                });\n            }\n        "),e.next=3,n.load(t);case 3:o=e.sent,a.props.onImageLoaded(o);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentWillReceiveProps",value:function(e){var t=e.image,a=t.file,n=t.src;!this.state.was_setup&&t&&(this.setState({image:t,was_setup:!0}),a?(this.processImage(a),this.uploadImage(a)):this.uploadImage(n))}},{key:"fileUpload",value:function(e,t,a,n){var o=new FormData;o.append(a,t);var s={headers:{"content-type":"multipart/form-data"},params:n};return Object(g.post)(e,o,s)}},{key:"uploadImage",value:function(e){var t=this,a={token:this.props.token};this.fileUpload(P+"/upload_post_images/",e,"photo",a).then(function(e){var a=e.data.images[0];console.log("Upload image result: ",a),t.props.onImageUpLoaded(a)}).catch(function(e){var t="";t=e.response?e.response.data:e.request?e.request:e.message,console.error("Upload image Error",t)})}},{key:"render",value:function(){var e=this.props.image,t=e.id,a=e.src,n=e.loading,s=-1!==t.toString().indexOf("ot-temp-id");return o.a.createElement("div",{className:"ot-new-post-image "+(n?"loading":"")+(s?" is-temp":"")},o.a.createElement("img",{src:a,alt:""}),o.a.createElement("button",{className:"ot-btn action",onClick:this.props.onRemoveImage},o.a.createElement("svg",{viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}))))}}]),t}(o.a.Component),Q=function(e){var t=e.readonly,a=e.images,n=e.videos,s=e.token;return o.a.createElement("div",{className:"ot-new-post-media"},n&&n.length>0&&o.a.createElement(I,{videos:n}),a&&a.length>0&&o.a.createElement("div",{className:"layout ot-new-post-images"},a.map(function(a,n){return o.a.createElement($,{key:n,image:a,token:s,onImageLoaded:function(o){t||e.onImageLoaded(a,n,o)},onImageUpLoaded:function(o){t||e.onImageUpLoaded(a,n,o)},onRemoveImage:function(){return e.onRemoveImage(n)}})})))},X=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(a=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={facingMode:"user"},a.setup=function(){var e=a.props,t=(e.video,e.audio);navigator.mediaDevices&&navigator.mediaDevices.getUserMedia({video:{facingMode:a.state.facingMode},audio:t}).then(function(e){a.setState({mediaStream:e}),a.video.srcObject=e,a.video.play()}).catch(function(e){return e})},a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentWillMount",value:function(){this.setup()}},{key:"capture",value:function(){var e=this.state.mediaStream.getVideoTracks()[0];return new window.ImageCapture(e).takePhoto()}},{key:"switchMode",value:function(){var e=this,t="environment"===this.state.facingMode?"user":"environment";this.setState({facingMode:t},function(){e.state.mediaStream.getVideoTracks()[0].stop(),e.setState({mediaStream:null}),setTimeout(function(){e.setup()})})}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{style:this.props.style},this.props.children,o.a.createElement("video",{ref:function(t){e.video=t}}))}}]),t}(n.Component);X.defaultProps={audio:!1,video:!0,style:{},children:null};var Z=X,ee=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(a=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={image:null},a.takePicture=function(){a.camera.capture().then(function(e){var t=URL.createObjectURL(e);a.img.src=t,a.setState({image:e}),console.log(t),a.img.onload=function(){URL.revokeObjectURL(a.src)}})},a.switchCameraMode=function(){a.camera.switchMode()},a.handleRepeat=function(){a.setState({image:null})},a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.state.image;return o.a.createElement("div",{id:"newPostCamera"},!t&&o.a.createElement(Z,{ref:function(t){e.camera=t}},o.a.createElement("div",{id:"captureContainer"},o.a.createElement("button",{className:"ot-btn flat",onClick:this.props.onCancel},"CANCEL"),o.a.createElement("div",{id:"captureButton",onClick:this.takePicture}),o.a.createElement("button",{className:"ot-btn action",onClick:this.switchCameraMode},o.a.createElement("svg",{viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),o.a.createElement("path",{d:"M20 4h-3.17L15 2H9L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-5 11.5V13H9v2.5L5.5 12 9 8.5V11h6V8.5l3.5 3.5-3.5 3.5z"}))))),o.a.createElement("img",{id:"captureImage",className:t?"":"hidden",ref:function(t){e.img=t},alt:""}),t&&o.a.createElement("div",{id:"captureContainer"},o.a.createElement("button",{className:"ot-btn flat",onClick:this.handleRepeat},"REPEAT"),o.a.createElement("button",{className:"ot-btn flat",onClick:function(){return e.props.onAddPicture(t)}},"CONTINUE")))}}]),t}(n.Component),te=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={takingPicture:!1},a.openCamera=function(){window.history.pushState({},"","#creatingOnMobile/takingPicture"),a.setState({takingPicture:!0})},a.closeCamera=function(){window.history.back(),a.setState({takingPicture:!1}),a.inputField&&console.log(a.inputField.current.textarea.focus())},a.handleAddPicture=function(e){a.closeCamera(),a.props.onAddPicture(e)},a.inputField=o.a.createRef(),a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.inputField&&console.log(this.inputField.current.textarea.focus()),window.onpopstate=function(){console.log("State popped!");var t=window.location.hash;console.log("Popstate hash: ",t),-1===t.indexOf("takingPicture")&&e.state.takingPicture&&e.setState({takingPicture:!1})}}},{key:"render",value:function(){var e=this,t=this.props,a=t.user,n=t.content,s=t.videos,i=t.images,r=this.state.takingPicture;return o.a.createElement(o.a.Fragment,null,r&&o.a.createElement(Y.a,{enabled:r},o.a.createElement(ee,{onCancel:this.closeCamera,onAddPicture:this.handleAddPicture})),o.a.createElement("div",{className:"ot-new-post-mobile"},o.a.createElement("div",{className:"ot-new-post-mobile-nav layout center"},o.a.createElement("button",{className:"ot-btn action",onClick:this.props.onBackClicked},o.a.createElement("svg",{viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"}))),o.a.createElement("span",null,"New Post"),o.a.createElement("span",{className:"flex"}),o.a.createElement("button",{className:"ot-btn flat",onClick:this.props.onSubmitClicked},"SEND")),o.a.createElement("div",{className:"ot-new-post-mobile-content"},o.a.createElement("div",{className:"ot-new-post-wrapper layout"},o.a.createElement("div",{className:"ot-dp"},o.a.createElement("img",{src:a.dp,alt:""})),o.a.createElement(W.a,{ref:this.inputField,placeholder:"Share your inisights...",className:"ot-new-post-text",rows:1,value:n,onFocus:function(){return e.props.onFocus(!0)},onBlur:function(){return e.props.onBlur(!1)},onChange:this.props.onChange,onKeyUp:this.props.onKeyUp})),o.a.createElement(Q,{readonly:!0,token:a.token,videos:s,images:i,onRemoveImage:this.props.onRemoveImage})),o.a.createElement("div",{className:"ot-new-post-mobile-actions layout center-center"},o.a.createElement("input",{type:"file",id:"mobileImages",onChange:this.props.onFilesPicked}),o.a.createElement("label",{className:"ot-btn flat",htmlFor:"mobileImages"},"ADD FILES"),"\u2003\u2003",o.a.createElement("button",{className:"ot-btn flat",onClick:this.openCamera},"TAKE PICTURE"))))}}]),t}(o.a.Component),ae=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={creatingOnMobile:!1,dragover:!1,focused:!1,content:"",images:[],videos:[]},a.FileDragHover=function(e){e.stopPropagation(),e.preventDefault();var t="dragleave"!==e.type&&"drop"!==e.type;setTimeout(function(){a.setState({dragover:t})},20)},a.FileSelectHandler=function(e){a.FileDragHover(e);var t=e.target.files||e.dataTransfer.files;t&&t.length&&a.processFiles(t)},a.imageLoaded=function(e,t,n){var o=Object(v.a)(a.state.images);e.src=n,e.loading=!1,o.splice(t,1,e),a.setState({images:o})},a.imageUpLoaded=function(e,t,n){var o=Object(v.a)(a.state.images);e.id=n.id,e.photo=n.photo,o.splice(t,1,e),a.setState({images:o})},a.removeImage=function(e){var t=Object(v.a)(a.state.images);t.splice(e,1),a.setState({images:t})},a.processFiles=function(e){var t=Array.from(e).filter(function(e){return-1!==e.type.indexOf("image")}).map(function(e){return{id:"ot-temp-id"+Math.random().toString(36).substr(2,5),file:e,loading:!0,src:""}}),n=4-a.state.images.length;n<0&&(n=0),n<t.length&&k(w("You can not upload more than 4 images")),a.setState({images:a.state.images.concat(Object(q.slice)(t,0,n))}),Array.from(e).filter(function(e){return-1===e.type.indexOf("image")}).forEach(function(e){var t=e.name.substr(0,15).trim();t+=e.name.length>15?"...":"",k(w("<strong>".concat(t,"</strong> is not an image")))})},a.setFocus=function(e){a.setState({focused:e}),e&&window.innerWidth<541&&a.openMobileCreate()},a.openMobileCreate=function(){window.history.pushState({},"","#creatingOnMobile"),a.setState({creatingOnMobile:!0})},a.closeMobileCreate=function(){window.history.back(),a.setState({creatingOnMobile:!1})},a.handleChange=function(e){var t=e.target.value,n=t.indexOf("https"),o=t.substr(n,t.length);a.setState({content:t},function(){if(-1!==n&&x(o)){var e=Object(v.a)(a.state.videos);e.push({video:o}),a.setState({videos:e}),a.setState({content:t.replace(o,"")})}})},a.handleKeyup=function(e){"Enter"===e.key&&a.state.content.length&&a.submitClicked()},a.handleAddPicture=function(e){var t="ot-temp-id"+Math.random().toString(36).substr(2,5);e.lastModifiedDate=new Date,e.name="ot-file-"+Math.random().toString(36).substr(2,5),a.setState({images:Object(v.a)(a.state.images).concat([{id:t,file:e,loading:!0,src:""}])})},a.sendPost=function(e,t,a){var n={headers:{"content-type":"multipart/form-data"},params:a};return Object(g.post)(e,t,n)},a.submitClicked=function(){var e=new FormData;if(e.append("content",a.state.content),a.closeMobileCreate(),a.state.images.length){var t=a.state.images[0].file;e.append("photo",t)}if(a.state.videos.length){var n=a.state.videos[0].video;e.set("content",a.state.content+n)}var o={token:a.props.user.token};a.sendPost(P+"/publish_post/",e,o).then(function(e){var t=e.data[0];console.log("Submit post result: ",t),t.status&&(a.props.onNewPost(t.post),a.setState({dragover:!1,focused:!1,content:"",images:[],videos:[]}))}).catch(function(e){var t="";t=e.response?e.response.data:e.request?e.request:e.message,console.error("Submit post Error",t)})},a.wrapper=o.a.createRef(),a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("dragover",this.FileDragHover,!1),window.addEventListener("dragleave",this.FileDragHover,!1),window.addEventListener("drop",this.FileSelectHandler,!1),this._isMounted=!0,window.onpopstate=function(){if(console.log("State popped!"),e._isMounted){var t=window.location.hash;console.log("Popstate hash: ",t),-1===t.indexOf("creatingOnMobile")&&e.state.creatingOnMobile&&e.setState({creatingOnMobile:!1})}}}},{key:"render",value:function(){var e=this,t=this.props.user,a=this.state,n=a.creatingOnMobile,s=a.dragover,i=a.focused,r=a.content,c=a.images,l=a.videos;(c.length||l.length)&&c.length;return o.a.createElement(o.a.Fragment,null,n&&o.a.createElement(te,{user:t,content:r,images:c,videos:l,onFocus:function(){return e.setFocus(!0)},onBlur:function(){return e.setFocus(!1)},onChange:this.handleChange,onKeyUp:this.handleKeyup,onFilesPicked:this.FileSelectHandler,onRemoveImage:this.removeImage,onSubmitClicked:this.submitClicked,onBackClicked:this.closeMobileCreate,onAddPicture:this.handleAddPicture}),o.a.createElement("div",{ref:this.wrapper,className:"ot-new-post "+(s?c.length?"dragging has-images":"dragging":"")},o.a.createElement("div",{className:"ot-new-post-wrapper layout"},o.a.createElement("div",{className:"ot-dp"},o.a.createElement("img",{src:t.dp,alt:""})),o.a.createElement(W.a,{placeholder:"Share your inisights...",className:"ot-new-post-text",rows:1,onFocus:function(){return e.setFocus(!0)},onBlur:function(){return e.setFocus(!1)},onChange:this.handleChange,onKeyUp:this.handleKeyup,value:r})),o.a.createElement(Q,{token:t.token,videos:l,images:c,onImageLoaded:this.imageLoaded,onImageUpLoaded:this.imageUpLoaded,onRemoveImage:this.removeImage}),o.a.createElement("div",{className:"layout end-justified ot-new-post-button-wrapper"+(r.length||i?" visible":"")},o.a.createElement("button",{className:"ot-btn flat"+(r.length?"":" disabled"),onClick:this.submitClicked},"POST"))),o.a.createElement("button",{className:"ot-btn fab ot-post-creator-fab",onClick:this.openMobileCreate},o.a.createElement("svg",{viewBox:"0 0 24 24"},o.a.createElement("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}))))}}]),t}(o.a.Component),ne=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(a=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={initial_fetch:!1,posts:[]},a.fetchUserPosts=function(){var e={token:a.state.token};f.a.get(P+"/wall/",{params:e}).then(function(e){var t=e.data;console.log("Fetch posts result",t),a.setState({posts:t,initial_fetch:!0})}).catch(function(e){console.error("Fetch posts Error",e),a.setState({initial_fetch:!0})})},a.toggleCommentLiked=function(e,t,n){var o=JSON.parse(JSON.stringify(e.comments[n])),s=o.is_liked,i=Object(v.a)(a.state.posts);o.is_liked=!s,e.comments.splice(n,1,o),i.splice(t,1,e),a.setState({posts:i});var r=P+(s?"/unlike_comment/":"/like_comment/"),c={token:a.state.token,comment_id:o.id};f.a.get(r,{params:c}).then(function(r){var c=r.data[0];console.log("Toggle Comment like response",c),c.status||(o.is_liked=s,e.comments.splice(n,1,o),i.splice(t,1,e),a.setState({posts:i}))}).catch(function(r){console.error("Toggle comment like Error",r),o.is_liked=s,e.comments.splice(n,1,o),i.splice(t,1,e),a.setState({posts:i})})},a.toggleLiked=function(e,t){var n=e.is_liked,o=Object(v.a)(a.state.posts);e.is_liked=!n,e.total_likes+=n?-1:1,o.splice(t,1,e),a.setState({posts:o});var s=P+(n?"/unlike_post/":"/like_post/"),i={token:a.state.token,post_id:e.id};f.a.get(s,{params:i}).then(function(s){s.data[0].status||(e.is_liked=n,o.splice(t,1,e),a.setState({posts:o}))}).catch(function(s){console.error("Toggle like Error",s),e.is_liked=n,o.splice(t,1,e),a.setState({posts:o})})},a.newPost=function(e){var t=Object(v.a)(a.state.posts);t.unshift(e),console.log(e,t),k(w("Your post has been submitted")),a.setState({posts:t})},a.addComment=function(e,t,n){var o=Object(L.a)({},e).comments.length;console.log(e.comments.length),e.total_comments+=1,e.total_commenets+=1;var s={id:"ot-temp-id"+Math.random().toString(36).substr(2,5),content:n,published_at:new Date,is_liked:!1,publisher:a.props.user};e.comments.push(s);var i=Object(v.a)(a.state.posts);i.splice(t,1,e),a.setState({posts:i});var r={token:a.state.token,post_id:e.id,content:n};f()({method:"POST",url:P+"/publish_comment/",params:r}).then(function(n){var r=n.data[0];console.log("Comment result: ",r),r.status?s.id=s.id.replace("ot-temp-id",""):(e.comments.splice(o,1),e.total_comments-=1,e.total_commenets-=1),i.splice(t,1,e),a.setState({posts:i})}).catch(function(n){var s="";s=n.response?n.response.data:n.request?n.request:n.message,console.error("Comment Error",s),e.comments.splice(o,1),i.splice(t,1,e),a.setState({posts:i})})},a.showComments=function(e,t){e.fetching_comments=!0;var n=Object(v.a)(a.state.posts);n.splice(t,1,e),a.setState({posts:n});var o={token:a.state.token,post_id:e.id};f.a.get(P+"/comments/",{params:o}).then(function(o){var s=o.data,i=s[0];console.log("Post Comments result: ",i),i.status&&(e.comments=s),e.fetching_comments=!1,n.splice(t,1,e),a.setState({posts:n})}).catch(function(o){var s="";s=o.response?o.response.data:o.request?o.request:o.message,console.error("Post Comments Error",s),e.fetching_comments=!1,n.splice(t,1,e),a.setState({posts:n})})},a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.user;this.setState({user:t}),this.setState({token:t.token},function(){e.fetchUserPosts()})}},{key:"render",value:function(){var e=this,t=this.state,a=t.scrolled,n=t.posts,s=t.initial_fetch,i=this.props.user;return o.a.createElement("div",{className:"ot-post-list-wrapper "+(a?"scrolled":"")},o.a.createElement(ae,{user:i,onNewPost:this.newPost}),o.a.createElement("div",{className:"ot-post-list"},!s&&o.a.createElement("span",null,"Fetching posts...."),s&&o.a.createElement(o.a.Fragment,null,n.map(function(t,a){return o.a.createElement(K,{key:t.id,post:t,user:i,onToggleLiked:function(){return e.toggleLiked(t,a)},onNewComment:function(n){return e.addComment(t,a,n)},onToggleCommentLiked:function(n){return e.toggleCommentLiked(t,a,n)},onShowComments:function(){return e.showComments(t,a)}})}))))}}]),t}(o.a.Component),oe=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(a=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(o)))).state={user:{},user_fetched:!1},a.fetchUser=Object(l.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,localStorage.getItem("ot-user");case 2:t=e.sent,a.setState({user_fetched:!0}),null!=t&&a.setState({user:JSON.parse(t)});case 5:case"end":return e.stop()}},e,this)})),a.login=function(e){var t={username:e.username,password:e.password};f()({method:"POST",url:"https://www.olbongo.com/api/login/",params:t}).then(function(e){var t=e.data;if(t.status){var n=t.user,o=t.token;n.token=o,localStorage.setItem("ot-user",JSON.stringify(n)),a.setState({user:n})}else alert("Wrong credentials!")}).catch(function(e){console.error("Login Error",e),alert("Wrong credentials")})},a.viewProfile=function(){console.log("View profile")},a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentWillMount",value:function(){this.fetchUser()}},{key:"render",value:function(){var e=this.state,t=e.user,a=e.user_fetched,n=t&&t.id&&t.token;return o.a.createElement("div",{className:"ot-app-wrapper",context:"counter1"},o.a.createElement(C,null),n&&o.a.createElement(M,{dp:t.dp,onViewProfile:this.viewProfile}),o.a.createElement("main",null,!n&&a&&o.a.createElement(S,{user:t,onLogin:this.login}),n&&o.a.createElement(ne,{user:t})))}}]),t}(o.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(oe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},39:function(e,t,a){e.exports=a.p+"static/media/logo.43803f22.png"},40:function(e,t,a){e.exports=a.p+"static/media/logo.43803f22.png"},47:function(e,t,a){e.exports=a(133)},54:function(e,t,a){},75:function(e,t,a){},77:function(e,t,a){},79:function(e,t,a){},81:function(e,t,a){},83:function(e,t,a){},85:function(e,t,a){},87:function(e,t,a){}},[[47,2,1]]]);
//# sourceMappingURL=main.8c04d225.chunk.js.map